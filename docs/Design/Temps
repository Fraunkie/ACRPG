-- UnitRoles.lua (tiny utility)
if Debug and Debug.beginFile then Debug.beginFile("UnitRoles") end
UnitRoles = UnitRoles or {}
_G.UnitRoles = UnitRoles

function UnitRoles.IsPlayerHero(u)
    if not u or GetUnitTypeId(u) == 0 then return false end
    local p = GetOwningPlayer(u); if not p then return false end
    local pid = GetPlayerId(p)
    local ph = PlayerHero and PlayerHero[pid]
    return ph ~= nil and ph == u
end

function UnitRoles.IterAllPlayerHeroesInRange(x, y, r, owner)
    local g, list = CreateGroup(), {}
    GroupEnumUnitsInRange(g, x, y, r or 700, nil)
    ForGroup(g, function()
        local u = GetEnumUnit()
        if UnitRoles.IsPlayerHero(u) and (not owner or IsPlayerAlly(GetOwningPlayer(u), owner)) then
            list[#list+1] = u
        end
    end)
    DestroyGroup(g)
    return list
end
if Debug and Debug.endFile then Debug.endFile() end
